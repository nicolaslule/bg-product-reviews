{"ast":null,"code":"var _jsxFileName = \"/Users/nicolaslule/Documents/Rails/bg-product-reviews/app/javascript/src/modules/components/pages/orders/orders.jsx\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState, useEffect } from 'react';\nimport { Button, Panel, Table, Text, Modal, AlertsManager, createAlertsManager, Badge } from '@bigcommerce/big-design';\nimport { DeleteIcon } from '@bigcommerce/big-design-icons';\nimport Loader from '../../common/Loader';\nimport { ApiService } from \"../../../../services/apiServices\";\nimport { alertsManager } from \"../../../../app\";\nexport default function Order(props) {\n  var storeId = props.storeId;\n\n  var _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isOpen = _useState4[0],\n      setIsOpen = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isDelete = _useState6[0],\n      setIsDelete = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      currentOrder = _useState8[0],\n      setCurrentOrder = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      currentStatus = _useState10[0],\n      setCurrentStatus = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      orders = _useState12[0],\n      setOrders = _useState12[1]; //Pagination\n\n\n  var _useState13 = useState(1),\n      _useState14 = _slicedToArray(_useState13, 2),\n      currentPage = _useState14[0],\n      setCurrentPage = _useState14[1];\n\n  var _useState15 = useState([5, 10, 20, 30]),\n      _useState16 = _slicedToArray(_useState15, 1),\n      itemsPerPageOptions = _useState16[0];\n\n  var _useState17 = useState(5),\n      _useState18 = _slicedToArray(_useState17, 2),\n      itemsPerPage = _useState18[0],\n      setItemsPerPage = _useState18[1];\n\n  var _useState19 = useState([]),\n      _useState20 = _slicedToArray(_useState19, 2),\n      currentItems = _useState20[0],\n      setCurrentItems = _useState20[1];\n\n  var onItemsPerPageChange = function onItemsPerPageChange(newRange) {\n    setCurrentPage(1);\n    setItemsPerPage(newRange);\n  };\n\n  function updateOrder(id, newStatus) {\n    setCurrentOrder(orders.find(function (element) {\n      return element.id == id;\n    }));\n    setCurrentStatus(newStatus);\n    setIsOpen(true);\n  }\n\n  function handleUpdate() {\n    setIsOpen(false);\n    setLoading(true);\n    ApiService.updateOrder({\n      store_id: storeId,\n      order_id: currentOrder.id,\n      status: currentStatus\n    }).then(function (response) {\n      var newOrders = orders;\n      var newOrder = orders.find(function (element) {\n        return element.id == currentOrder.id;\n      });\n      newOrder.status = currentStatus;\n      var findIndex = orders.findIndex(function (order) {\n        return order.id === currentOrder.id;\n      });\n      newOrders[findIndex] = newOrder;\n      setOrders(newOrders);\n      AddAlert('Order Update', 'Order Has Been Cancelled Successfully!', 'success');\n      setLoading(false);\n    })[\"catch\"](function (error) {\n      console.log(error);\n      AddAlert('Error', 'Something Went Wrong, Please Try Again!', 'error');\n      setLoading(false);\n    });\n  }\n\n  function handleDelete() {\n    setIsDelete(false);\n    setLoading(true);\n    ApiService.deleteOrder({\n      store_id: storeId,\n      order_id: currentOrder.id\n    }).then(function (response) {\n      var newOrders = orders;\n      newOrders = orders.filter(function (order) {\n        return order.id !== currentOrder.id;\n      });\n      setOrders(newOrders);\n      AddAlert('Order Delete', 'Order Has Been Deleted Successfully!', 'success');\n      setLoading(false);\n    })[\"catch\"](function (error) {\n      console.log(error);\n      AddAlert('Error', 'Something Went Wrong, Please Try Again!', 'error');\n      setLoading(false);\n    });\n  }\n\n  function AddAlert(title, details, type) {\n    var alert = {\n      header: title,\n      messages: [{\n        text: details\n      }],\n      type: type,\n      onClose: function onClose() {\n        return null;\n      },\n      autoDismiss: true\n    };\n    alertsManager.add(alert);\n  }\n\n  function orderStatus(status) {\n    switch (status) {\n      case 'Completed':\n        return /*#__PURE__*/React.createElement(Badge, {\n          variant: \"success\",\n          label: status,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 17\n          }\n        });\n        break;\n\n      case 'Awaiting Fulfillment':\n        return /*#__PURE__*/React.createElement(Badge, {\n          variant: \"secondary\",\n          label: status,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 17\n          }\n        });\n        break;\n\n      case 'Cancelled':\n        return /*#__PURE__*/React.createElement(Badge, {\n          variant: \"danger\",\n          label: status,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 17\n          }\n        });\n        break;\n\n      default:\n        return /*#__PURE__*/React.createElement(Badge, {\n          variant: \"secondary\",\n          label: status,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 17\n          }\n        });\n    }\n  }\n\n  function orderUpdate(id, status) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, !['Completed', 'Cancelled'].includes(status) && /*#__PURE__*/React.createElement(Button, {\n      onClick: function onClick() {\n        return updateOrder(id, 'Cancelled');\n      },\n      actionType: \"destructive\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }\n    }, \"Cancel\"));\n  }\n\n  function renderOnDelete(id) {\n    return /*#__PURE__*/React.createElement(Button, {\n      variant: \"subtle\",\n      actionType: \"destructive\",\n      onClick: function onClick() {\n        return updateDeleteOrder(id);\n      },\n      iconOnly: /*#__PURE__*/React.createElement(DeleteIcon, {\n        title: \"Delete Product\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 19\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 7\n      }\n    });\n  }\n\n  function updateDeleteOrder(id) {\n    setCurrentOrder(orders.find(function (element) {\n      return element.id == id;\n    }));\n    setIsDelete(true);\n  }\n\n  useEffect(function () {\n    ApiService.getOrders({\n      store_id: storeId\n    }).then(function (response) {\n      setOrders(response.data.orders);\n      setLoading(false);\n      var maxItems = currentPage * itemsPerPage;\n      var lastItem = Math.min(maxItems, response.data.orders.length);\n      var firstItem = Math.max(0, maxItems - itemsPerPage);\n      setCurrentItems(response.data.orders.slice(firstItem, lastItem));\n    })[\"catch\"](function (error) {\n      console.log(error);\n    });\n  }, []);\n  useEffect(function () {\n    var maxItems = currentPage * itemsPerPage;\n    var lastItem = Math.min(maxItems, orders.length);\n    var firstItem = Math.max(0, maxItems - itemsPerPage);\n    setCurrentItems(orders.slice(firstItem, lastItem));\n  }, [currentPage, itemsPerPage]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(AlertsManager, {\n    manager: alertsManager,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }\n  }), loading && /*#__PURE__*/React.createElement(Loader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }\n  }), !loading && /*#__PURE__*/React.createElement(Panel, {\n    header: \"Orders \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    columns: [{\n      header: 'Order ID',\n      hash: 'id',\n      render: function render(_ref) {\n        var id = _ref.id;\n        return id;\n      }\n    }, {\n      header: 'Billing Name',\n      hash: 'billing_address',\n      render: function render(_ref2) {\n        var billing_address = _ref2.billing_address;\n        return billing_address.first_name;\n      }\n    }, {\n      header: 'Order Total',\n      hash: 'subtotal_inc_tax',\n      render: function render(_ref3) {\n        var subtotal_inc_tax = _ref3.subtotal_inc_tax;\n        return \"$ \".concat(Number(subtotal_inc_tax).toFixed(2));\n      }\n    }, {\n      header: 'Order Status',\n      hash: 'status',\n      render: function render(_ref4) {\n        var status = _ref4.status;\n        return orderStatus(status);\n      }\n    }, {\n      header: '',\n      hash: 'id',\n      render: function render(_ref5) {\n        var id = _ref5.id,\n            status = _ref5.status;\n        return orderUpdate(id, status);\n      }\n    }, {\n      header: '',\n      hash: 'id',\n      render: function render(_ref6) {\n        var id = _ref6.id;\n        return renderOnDelete(id);\n      }\n    }],\n    items: currentItems,\n    itemName: \"Orders\",\n    pagination: {\n      currentPage: currentPage,\n      totalItems: orders.length,\n      onPageChange: setCurrentPage,\n      itemsPerPageOptions: itemsPerPageOptions,\n      onItemsPerPageChange: onItemsPerPageChange,\n      itemsPerPage: itemsPerPage\n    },\n    stickyHeader: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Modal, {\n    actions: [{\n      text: 'Cancel',\n      variant: 'subtle',\n      onClick: function onClick() {\n        return setIsOpen(false);\n      }\n    }, {\n      text: 'Confirm',\n      onClick: function onClick() {\n        return handleUpdate();\n      }\n    }],\n    header: \"Update Order\",\n    isOpen: isOpen,\n    onClose: function onClose() {\n      return setIsOpen(false);\n    },\n    closeOnEscKey: true,\n    closeOnClickOutside: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 11\n    }\n  }, \"Are you sure you want to mark \", currentStatus, \" this order?\")), /*#__PURE__*/React.createElement(Modal, {\n    actions: [{\n      text: 'Cancel',\n      variant: 'subtle',\n      onClick: function onClick() {\n        return setIsDelete(false);\n      }\n    }, {\n      text: 'Delete',\n      onClick: function onClick() {\n        return handleDelete();\n      }\n    }],\n    header: \"Delete Order\",\n    isOpen: isDelete,\n    onClose: function onClose() {\n      return setIsDelete(false);\n    },\n    closeOnEscKey: true,\n    closeOnClickOutside: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }, \"Do you really want to delete order with id # \", currentOrder.id, \" ?\"))));\n}","map":{"version":3,"sources":["/Users/nicolaslule/Documents/Rails/bg-product-reviews/app/javascript/src/modules/components/pages/orders/orders.jsx"],"names":["React","useState","useEffect","Button","Panel","Table","Text","Modal","AlertsManager","createAlertsManager","Badge","DeleteIcon","Loader","ApiService","alertsManager","Order","props","storeId","loading","setLoading","isOpen","setIsOpen","isDelete","setIsDelete","currentOrder","setCurrentOrder","currentStatus","setCurrentStatus","orders","setOrders","currentPage","setCurrentPage","itemsPerPageOptions","itemsPerPage","setItemsPerPage","currentItems","setCurrentItems","onItemsPerPageChange","newRange","updateOrder","id","newStatus","find","element","handleUpdate","store_id","order_id","status","then","response","newOrders","newOrder","findIndex","order","AddAlert","error","console","log","handleDelete","deleteOrder","filter","title","details","type","alert","header","messages","text","onClose","autoDismiss","add","orderStatus","orderUpdate","includes","renderOnDelete","updateDeleteOrder","getOrders","data","maxItems","lastItem","Math","min","length","firstItem","max","slice","hash","render","billing_address","first_name","subtotal_inc_tax","Number","toFixed","totalItems","onPageChange","variant","onClick"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport {\n  Button,\n  Panel,\n  Table,\n  Text,\n  Modal,\n  AlertsManager,\n  createAlertsManager,\n  Badge\n} from '@bigcommerce/big-design';\nimport { DeleteIcon } from '@bigcommerce/big-design-icons';\n\nimport Loader from '../../common/Loader';\nimport {ApiService} from \"../../../../services/apiServices\";\nimport { alertsManager } from \"../../../../app\";\n\nexport default function Order(props) {\n  let {storeId} = props;\n\n  const [loading, setLoading] = useState(true);\n  const [isOpen, setIsOpen] = useState(false);\n  const [isDelete, setIsDelete] = useState(false);\n  const [currentOrder, setCurrentOrder] = useState('');\n  const [currentStatus, setCurrentStatus] = useState('');\n  const [orders, setOrders] = useState([]);\n\n  //Pagination\n  const [currentPage, setCurrentPage] = useState(1);\n  const [itemsPerPageOptions] = useState([5, 10, 20, 30]);\n  const [itemsPerPage, setItemsPerPage] = useState(5);\n  const [currentItems, setCurrentItems] = useState([]);\n\n  const onItemsPerPageChange = (newRange) => {\n    setCurrentPage(1);\n    setItemsPerPage(newRange);\n  };\n\n  function updateOrder(id, newStatus){\n    setCurrentOrder(orders.find(element => element.id == id));\n    setCurrentStatus(newStatus);\n    setIsOpen(true);\n  }\n\n  function handleUpdate(){\n    setIsOpen(false);\n    setLoading(true);\n    ApiService.updateOrder({store_id: storeId, order_id: currentOrder.id, status: currentStatus})\n      .then(function (response){\n        let newOrders = orders\n        let newOrder = orders.find(element => element.id == currentOrder.id)\n        newOrder.status = currentStatus\n        const findIndex = orders.findIndex( order => order.id === currentOrder.id);\n        newOrders[findIndex] = newOrder;\n        setOrders(newOrders);\n        AddAlert('Order Update', 'Order Has Been Cancelled Successfully!', 'success')\n        setLoading(false);\n      })\n      . catch(function (error) {\n        console.log(error);\n        AddAlert('Error', 'Something Went Wrong, Please Try Again!', 'error')\n        setLoading(false);\n      })\n  }\n\n  function handleDelete() {\n    setIsDelete(false);\n    setLoading(true);\n    ApiService.deleteOrder({store_id: storeId, order_id: currentOrder.id})\n      .then(function (response){\n        let newOrders = orders\n        newOrders = orders.filter(order => order.id !== currentOrder.id)\n        setOrders(newOrders);\n        AddAlert('Order Delete', 'Order Has Been Deleted Successfully!', 'success')\n        setLoading(false);\n      })\n      . catch(function (error) {\n        console.log(error);\n        AddAlert('Error', 'Something Went Wrong, Please Try Again!', 'error')\n        setLoading(false);\n      })\n  }\n\n  function AddAlert(title, details, type) {\n    const alert = {\n      header: title,\n      messages: [\n        {\n          text: details,\n        },\n      ],\n      type: type,\n      onClose: () => null,\n      autoDismiss: true\n    }\n    alertsManager.add(alert);\n  }\n\n  function orderStatus(status){\n    switch(status) {\n      case 'Completed':\n        return (<Badge variant=\"success\" label={status}/>)\n        break;\n      case 'Awaiting Fulfillment':\n        return (<Badge variant=\"secondary\" label={status}/>)\n        break;\n      case 'Cancelled':\n        return (<Badge variant=\"danger\" label={status}/>)\n        break;\n      default:\n        return (<Badge variant=\"secondary\" label={status}/>)\n    }\n  }\n\n  function orderUpdate(id, status){\n    return(\n      <>\n        { !['Completed', 'Cancelled'].includes(status) &&\n        <Button onClick={() => updateOrder(id, 'Cancelled')} actionType=\"destructive\">Cancel</Button>\n        }\n      </>\n    )\n  }\n\n  function renderOnDelete(id) {\n    return(\n      <Button\n        variant=\"subtle\"\n        actionType=\"destructive\"\n        onClick={() => updateDeleteOrder(id)}\n        iconOnly={<DeleteIcon title=\"Delete Product\" />}\n      />\n    )}\n\n  function updateDeleteOrder(id){\n    setCurrentOrder(orders.find(element => element.id == id));\n    setIsDelete(true);\n  }\n\n  useEffect(() => {\n    ApiService.getOrders({store_id: storeId})\n      .then(function (response) {\n        setOrders(response.data.orders)\n        setLoading(false);\n\n        const maxItems = currentPage * itemsPerPage;\n        const lastItem = Math.min(maxItems, response.data.orders.length);\n        const firstItem = Math.max(0, maxItems - itemsPerPage);\n        setCurrentItems(response.data.orders.slice(firstItem, lastItem));\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n  }, []);\n\n  useEffect(() => {\n    const maxItems = currentPage * itemsPerPage;\n    const lastItem = Math.min(maxItems, orders.length);\n    const firstItem = Math.max(0, maxItems - itemsPerPage);\n\n    setCurrentItems(orders.slice(firstItem, lastItem));\n  }, [currentPage, itemsPerPage]);\n\n  return(\n    <>\n      <AlertsManager manager={alertsManager} />\n      { loading &&\n      <Loader />\n      }\n      { !loading &&\n      <Panel header=\"Orders \">\n        <Table\n          columns={[\n            { header: 'Order ID', hash: 'id', render: ({ id }) => id },\n            { header: 'Billing Name', hash: 'billing_address', render: ({ billing_address }) => billing_address.first_name },\n            { header: 'Order Total', hash: 'subtotal_inc_tax', render: ({ subtotal_inc_tax }) => `$ ${Number(subtotal_inc_tax).toFixed(2)}` },\n            { header: 'Order Status', hash: 'status', render:  ({ status }) => orderStatus(status) },\n            { header: '', hash: 'id', render: ({ id, status }) => orderUpdate(id, status) },\n            { header: '', hash: 'id', render: ({ id }) => renderOnDelete(id) },\n          ]}\n          items={currentItems}\n          itemName=\"Orders\"\n          pagination={{\n            currentPage,\n            totalItems: orders.length,\n            onPageChange: setCurrentPage,\n            itemsPerPageOptions,\n            onItemsPerPageChange,\n            itemsPerPage,\n          }}\n          stickyHeader\n        />\n        <Modal\n          actions={[\n            { text: 'Cancel', variant: 'subtle', onClick: () => setIsOpen(false) },\n            { text: 'Confirm', onClick: () => handleUpdate() },\n          ]}\n          header=\"Update Order\"\n          isOpen={isOpen}\n          onClose={() => setIsOpen(false)}\n          closeOnEscKey={true}\n          closeOnClickOutside={true}\n        >\n          <Text>\n            Are you sure you want to mark {currentStatus} this order?\n          </Text>\n        </Modal>\n        <Modal\n          actions={[\n            { text: 'Cancel', variant: 'subtle', onClick: () => setIsDelete(false) },\n            { text: 'Delete', onClick: () => handleDelete() },\n          ]}\n          header=\"Delete Order\"\n          isOpen={isDelete}\n          onClose={() => setIsDelete(false)}\n          closeOnEscKey={true}\n          closeOnClickOutside={true}\n        >\n          <Text>\n            Do you really want to delete order with id # {currentOrder.id} ?\n          </Text>\n        </Modal>\n      </Panel>\n      }\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}